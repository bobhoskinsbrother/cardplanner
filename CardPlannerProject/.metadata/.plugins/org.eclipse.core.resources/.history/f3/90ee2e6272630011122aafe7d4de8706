package uk.co.itstherules.cardplanner.model;

import java.util.List;

import org.hamcrest.BaseMatcher;
import org.hamcrest.Description;
import org.hamcrest.Matcher;
import org.junit.Assert;
import org.junit.Test;
import org.junit.internal.matchers.TypeSafeMatcher;

import uk.co.itstherules.cardplanner.model.type.EffortTypeModel;
import uk.co.itstherules.cardplanner.model.type.ValueTypeModel;
import uk.co.itstherules.yawf.model.PageModel;
import uk.co.itstherules.yawf.model.ProcessStepModel;
import uk.co.itstherules.yawf.model.ProcessStepReferenceModel;
import uk.co.itstherules.yawf.model.RouteModel;
import uk.co.itstherules.yawf.model.SimpleAttachmentModel;
import uk.co.itstherules.yawf.model.TemplateModel;
import uk.co.itstherules.yawf.security.objectcache.GroupModel;
import uk.co.itstherules.yawf.security.objectcache.PermissionModel;
import static org.junit.Assert.*;

public class CachedInstanceTest {
	@Test
	public void checkThatDefaultObjectsAreSaved() {
		FakeObjectCache fakeObjectCache = new FakeObjectCache();
		CachedInstance unit = new CachedInstance();
		
		unit.initialise(fakeObjectCache);
		
		List<Object> objects = fakeObjectCache.getObjects();
		assertThat(objects, contains(1, ConfigurationModel.class));
		
		Assert.assertTrue(containsInstance(ConfigurationModel.class, objects));
		Assert.assertTrue(containsInstance(StatusModel.class, objects));
		Assert.assertTrue(containsInstance(EffortTypeModel.class, objects));
		Assert.assertTrue(containsInstance(ValueTypeModel.class, objects));
		Assert.assertTrue(containsInstance(SimpleAttachmentModel.class, objects));
		Assert.assertTrue(containsInstance(CardTypeModel.class, objects));
		Assert.assertTrue(containsInstance(CardModel.class, objects));
		Assert.assertTrue(containsInstance(PersonModel.class, objects));

	}
	
	
	private Matcher<List<Object>> contains(int amount, Class<ConfigurationModel> theClass) {
		return new ContainsAmountOfInstancesOfClasses(amount, theClass);
	}


	public boolean containsInstance(Class<?> classNeeded, List<Object> objects) {
		for (Object object : objects) {
	        if(classNeeded.isInstance(object)) return true;
        }
		return false;
	}
	
	private static class ContainsAmountOfInstancesOfClasses extends TypeSafeMatcher<List<Object>> {

		private final int amount;
		private final Class<ConfigurationModel> theClass;

		public ContainsAmountOfInstancesOfClasses(int amount, Class<ConfigurationModel> theClass) {
			this.amount = amount;
			this.theClass = theClass;
		}

		public void describeTo(Description arg0) {
			// TODO Auto-generated method stub
			
		}

		@Override
		public boolean matchesSafely(List<Object> arg0) {
			// TODO Auto-generated method stub
			return false;
		}
		
	}
}



/*
ConfigurationModel.class

StatusModel.class
StatusModel.class
StatusModel.class
StatusModel.class

TemplateModel.class
TemplateModel.class
TemplateModel.class
TemplateModel.class
TemplateModel.class
TemplateModel.class
TemplateModel.class
TemplateModel.class 
TemplateModel.class
TemplateModel.class 

PageModel.class
PageModel.class
PageModel.class
PageModel.class 
PageModel.class 
PageModel.class
PageModel.class

ValueTypeModel.class
EffortTypeModel.class
SimpleAttachmentModel.class
CardModel.class
CardTypeModel.class
PersonModel.class
EmailDetailsModel.class

EffortModel.class
ValueModel.class

PermissionModel.class

GroupModel.class
GroupModel.class

PersonModel.class
RouteModel.class
RouteModel.class
RouteModel.class

ProcessStepModel.class
ProcessStepModel.class
ProcessStepModel.class
ProcessStepModel.class
ProcessStepModel.class
ProcessStepModel.class
ProcessStepModel.class
ProcessStepModel.class
ProcessStepModel.class
ProcessStepModel.class

ProcessStepModel.class
ProcessStepModel.class

ProcessStepReferenceModel.class
ProcessStepReferenceModel.class
ProcessStepReferenceModel.class
ProcessStepReferenceModel.class
ProcessStepReferenceModel.class
ProcessStepReferenceModel.class
ProcessStepReferenceModel.class
ProcessStepReferenceModel.class
ProcessStepReferenceModel.class
ProcessStepReferenceModel.class
ProcessStepReferenceModel.class
ProcessStepReferenceModel.class
*/
